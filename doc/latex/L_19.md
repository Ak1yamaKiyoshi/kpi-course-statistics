## Лекція 19. КОРЕЛЯЦІЯ. ВИБІРКОВИЙ КОЕФІЦІЄНТ КОРЕЛЯЦІЇ. Ранг

19.1. Поняття кореляції, коефіцієнта кореляції

Кореляційною називають таку залежність між ознаками $X$ та $Y$, коли при зміні однієї з ознак змінюється середнє значення іншої.

Кореляційний аналіз використовують для визначення сили статистичних зав'язків між двома наборами даних.

Форму зв'язку між змінними $X$ і $Y$ можна встановити, застосовуючи кореляційні поля.

На основі аналізу кореляційного поля можна вирішити питання про наявність чи відсутність залежності між ознаками, прослідкувати характер залежності (лінійна, нелінійна, функціональна чи статистична) та її тенденцію (додатну чи від'ємну).

Приклад 19.1. Задано двовимірну вибірку

| $x_{i}$ | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| $y_{i}$ | 2 | 3,7 | 6,2 | 7,9 | 9,9 | 12 | 14,1 | 16,3 | 17,8 | 19,9 |

Побудувати кореляційне поле.
Розв'язок. Відкладемо на площині $x O y$ точки з координатами ( $1 ; 2$ ), $(2 ; 3,7),(3 ; 6,2)$ та ін. Отримаємо кореляційне поле для значень ознак $X$ та $Y$, на якому чітко видно лінійну залежність $Y$ від $X$.
![](https://cdn.mathpix.com/cropped/2025_05_11_cd0672ec52ebd3980e2bg-01.jpg?height=494&width=1052&top_left_y=1946&top_left_x=582)

Основною задачею кореляційного аналізу є виявлення зв'язку між випадковими величинами та оцінка його тісноти.

Для оцінки тісноти кореляційної залежності між ознаками служить коефіиієнт кореляції.

Коефіцієнт кореляції Пірсона між двома змінними дорівнює коваріації двох змінних, або сумі добутків відхилень, поділеній на добуток їх стандартних відхилень.

$$
r_{x y}=\frac{\sum\left(x_{i}-\bar{x}\right)\left(y_{i}-\bar{y}\right)}{\sqrt{\sum\left(x_{i}-\bar{x}\right)^{2}\left(y_{i}-\bar{y}\right)^{2}}} \frac{\overline{x y}-\bar{x} \cdot \bar{y}}{\sigma_{x} \cdot \sigma_{y}}=\frac{\operatorname{cov}(X, Y)}{\sigma_{x} \cdot \sigma_{y}}
$$

Коефіщієнт кореляції Спірмена визначається як коефіцієнт кореляції Пірсона між ранжованими змінними. Для вибірки обсягу $n$ множини $X_{i}, Y_{i}$ перетворюються в ряди $x_{i}, y_{i}$ та обчислюється наступним чином.

$$
\rho=\frac{\sum\left(x_{i}-\bar{x}\right)\left(y_{i}-\bar{y}\right)}{\sqrt{\sum\left(x_{i}-\bar{x}\right)^{2}\left(y_{i}-\bar{y}\right)^{2}}}
$$

Коефіцієнт кореляції Кендалла є мірою рангової кореляції, тобто подібності упорядкування даних, коли вони упорядкуванні за своєю величиною.

$$
\tau=\frac{s_{1}-s_{2}}{0,5 n(n-1)}
$$

де $s_{1}$ - кількість узгоджених пар, $s_{2}$ - кількість неузгоджених пар.

Коефішієнт кореляції Пірсона
Вибірковим коефіцієнтом кореляції $\left(r_{x y}\right)$ називається відношення різниці між математичним сподіванням добутку випадкових величин та добутку їх математичних сподівань до добутку середніх квадратичних відхилень цих випадкових величин:

$$
r_{x y}=\frac{\overline{x y}-\bar{x} \cdot \bar{y}}{\sigma_{x} \cdot \sigma_{y}}=\frac{\operatorname{cov}(X, Y)}{\sigma_{x} \cdot \sigma_{y}}
$$

де $\operatorname{cov}(X, Y)$ - коваріація.

Приклад 19.2. Задано двовимірну вибірку об'ємом $n=11$.

| $x_{i}$ | -4 | -3 | -2 | -1 | 0 | 1 | 2 | 3 | 4 | 5 | 6 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| $y_{i}$ | 25 | 16 | 9 | 4 | 1 | 0 | 1 | 4 | 9 | 16 | 25 |

Обчислити коваріацію та вибірковий коефіцієнт кореляції. Перевірити, чи існує залежність між ознаками $X$ та $Y$.

Розв'язок. Знайдемо значення $\bar{x}$ та $\bar{y}$.
$\bar{x}=\frac{\sum_{i=1}^{n} x_{i}}{n}=\frac{-4+(-3)+(-2)+(-1)+0+1+2+3+4+5+6}{11}=1 ;$
$\bar{y}=\frac{\sum_{i=1}^{n} y_{i}}{n}=\frac{25+16+9+4+1+0+1+4+9+16+25}{11}=10$.
Обчислимо коваріацію за формулою для незгрупованих даних
$\operatorname{cov}(X, Y)=\frac{\sum_{i=1}^{n} x_{i} y_{i}}{n}-\bar{x} \cdot \bar{y}=\frac{-4 \cdot 25+(-3) \cdot 16+(-2) \cdot 9+(-1) \cdot 4+0 \cdot 1}{11}+$ $+\frac{1 \cdot 9+2 \cdot 1+3 \cdot 4+4 \cdot 9+5 \cdot 16+6 \cdot 25}{11}-1 \cdot 10=0$.

Вибірковий коефіцієнт кореляції
$r_{x y}=\frac{\operatorname{cov}(X, Y)}{\sigma_{x} \cdot \sigma_{y}}=\frac{0}{\sigma_{x} \cdot \sigma_{y}}=0$.
![](https://cdn.mathpix.com/cropped/2025_05_11_cd0672ec52ebd3980e2bg-03.jpg?height=615&width=1278&top_left_y=1948&top_left_x=509)

На практиці найчастіше використовують іншу модифікацію формули вибіркового коефіцієнта кореляції, за якою $r_{x y}$ знаходять без округлення даних, пов'язаних з розрахунком середніх і відхилень від них:

$$
r_{x y}=\frac{n \cdot \sum_{i=1}^{n} x_{i} y_{i}-\sum_{i=1}^{n} x_{i} \cdot \sum_{i=1}^{n} y_{i}}{\sqrt{n \cdot \sum_{i=1}^{n} x_{i}^{2}-\left(\sum_{i=1}^{n} x_{i}\right)^{2}} \cdot \sqrt{n \cdot \sum_{i=1}^{n} y_{i}^{2}-\left(\sum_{i=1}^{n} y_{i}\right)^{2}}}
$$

## Властивості вибіркового коефіиієнта кореляції

1. $r_{x y}$ за абсолютною величиною $\leq 1$.
2. Якщо $r_{x y}=0$, то $X$ та $Y$ не пов'язані лінійною кореляційною залежністю, але інша залежність при цьому може мати місце.
3. Якщо $\left|r_{x y}\right|=1$, то $X$ та $Y$ пов'язані лінійною кореляційною залежністю.
4. Якщо при зростанні однієї випадкової величини інша має тенденцію до зростання, то маємо позитивну кореляцію $r_{x y}>0$; якщо при зростанні однієї випадкової величини інше спадає, то маємо обернену кореляцію $r_{x y}<0$. Залежність тим ближча до лінійної, чим $\left|r_{x y}\right|$ ближчий до одиниці.

Для оцінки тісноти нелінійного кореляційного зв'язку використовують такі характеристики, як вибіркове кореляційне відношення $Y$ по $X\left(\eta_{y x}\right)$ та вибіркове кореляційне відношення $X$ по $Y\left(\eta_{x y}\right)$. При цьому згадаємо правило додавання дисперсій: $D_{\text {заг. }}=D_{\text {сер.грул. }}+D_{\text {між.груп. }}$ (загальна дисперсія змінної дорівнює сумі середньої групових дисперсій (залишкової) та міжгрупової дисперсії).

## 19.2. Перевірка гіпотез про значущість коефіціснтів кореляції

Перевірка гіпотези про значущість вибіркового коефіцієнта кореляції.

## Кількісна

Кількісна

Хочемо перевірити: чи впливає кількісний фактор на кількісний відгук. $H_{0}$ : фактор не впливає на відгук.

Математичний зміст критерію: оцінка величини коефіцієнта кореляції - міри лінійного зв'язку між фактором та відгуком.

Для того, щоб при рівні значущості $\alpha$ перевірити нульову гіпотезу $H_{0}: r_{\Gamma}=0$ про рівність нулю генерального коефіцієнта кореляції при конкуруючій гіпотезі $H_{1}: r_{\Gamma} \neq 0$, необхідно обчислити спостережене значення критерію

$$
T_{\text {cnocm }}=r_{b} \sqrt{\frac{n-2}{1-r_{b}^{2}}}
$$

де $r_{b}$ - вибірковий коефіцієнт кореляції, $n$ - об'єм вибірки.
Із таблиці критичних точок розподілу Стьюдента (додаток 6), за заданим рівнем значущості $\alpha$ і числу ступенів вільності $k=n-2$ знаходять критичну точку $t_{\kappa p}\left(\frac{\alpha}{2} ; k\right)$.

Якщо $\left|T_{c п о с m}\right|<t_{\kappa p}$ - нульову гіпотези приймають. Якщо $\left|T_{c п о с m}\right|>t_{\kappa p}$ нульову гіпотезу відкидають.

Якщо нульова гіпотеза правильна, то між досліджуваними ознаками $X$ та $Y$ лінійний зв'язок відсутній. Якщо нульова гіпотеза відхиляється, то між досліджуваними ознаками $X$ та $Y$ існує статистично значущий лінійний зв'язок. Сила і напрям лінійного зв'язку визначаються величиною вибіркового коефіцієнта кореляції.

Приклад 19.4. Провели дослідження залежності середнього часу обслуговування клієнтів банку від стажу роботи працівника.

Знайдений вибірковий коефіцієнт кореляції дорівнює $r_{b}=0,7$. Об'єм вибірки складає $n=10$.

При рівні значущості $\alpha=0,1$ перевірити нульову гіпотезу $H_{0}: r_{\Gamma}=0$ про рівність нулю генерального коефіцієнта кореляції. За альтернативну прийняти гіпотезу $H_{1}: r_{\Gamma} \neq 0$.

Розв'язання: Знайдемо спостережене значення критерію

$$
T_{\text {cnocm }}=r_{b} \sqrt{\frac{n-2}{1-r_{b}^{2}}}=0,7 \cdot \sqrt{\frac{10-2}{1-0,7^{2}}}=2,77 .
$$

Із таблиці критичних точок розподілу Стьюдента (додаток 6), за заданим рівнем значущості $\alpha=0,1$ і числу ступенів вільності $k=8$ знаходимо критичну точку $t_{\kappa p}\left(\frac{\alpha}{2} ; k\right)=t_{\kappa p}\left(\frac{0,1}{2} ; k\right)=t_{\kappa p}(0,05 ; 8)=1,86$.
$\left|T_{\text {cnocm }}\right|>t_{\kappa p}$ - нульову гіпотезу відкидаємо. Між середнім часом обслуговування клієнтів банку і стажем роботи працівника існує прямий лінійний зв'язок.

Перевірка гіпотези про значушість вибіркового коефіцієнта рангової кореляції Спірмена

Для того, щоб при рівні значущості $\alpha$ перевірити нульову гіпотезу $H_{0}: \rho_{\Gamma}=0$ про рівність нулю генерального коефіцієнта рангової кореляції Спірмена при конкуруючій гіпотезі $H_{1}: \rho_{\Gamma} \neq 0$, необхідно обчислити критичну точку

$$
T_{\kappa p}=t_{\kappa p}\left(\frac{\alpha}{2} ; k\right) \cdot \sqrt{\frac{1-\rho_{b}^{2}}{n-2}},
$$

де $\rho_{6}$ - вибірковий ранговий коефіцієнт кореляції Спірмена, $n$ - об'єм вибірки, $t_{\kappa p}\left(\frac{\alpha}{2} ; k\right)$ - критична точка, яку знаходять із таблиці критичних точок

розподілу Стьюдента (додаток 6), за заданим рівнем значущості $\alpha$ і числу ступенів вільності $k=n-2$.

Якщо $\left|\rho_{b}\right|<T_{\kappa p}$ - нульову гіпотези приймають. Ранговий кореляційний зв'язок між досліджуваними ознаками статистично незначущий. Якщо $\left|\rho_{b}\right|>T_{\kappa p}$ - нульову гіпотезу відкидають. Між досліджуваними ознаками існує значущий ранговий кореляційний зв'язок.

Приклад 19.5. Експертна комісія оцінила 10 виробів за двома ознаками $A$ та $B$.

Знайдений коефіцієнт рангової кореляції Спірмена дорівнює $\rho_{6}=0,5$.
При рівні значущості $\alpha=0,1$ перевірити нульову гіпотезу $H_{0}: \rho_{\Gamma}=0$ про рівність нулю генерального коефіцієнта рангової кореляції Спірмена. За альтернативну прийняти гіпотезу $H_{1}: \rho_{\Gamma} \neq 0$.

Розв'язок. Із таблиці критичних точок розподілу Стьюдента (додаток 6), за заданим рівнем значущості $\alpha=0,1$ і числу ступенів вільності $k=8$ знаходимо критичну точку $t_{\kappa p}\left(\frac{\alpha}{2} ; k\right)=t_{\kappa p}(0,05 ; 8)=1,86$.

Знайдемо значення критичної точки $T_{\kappa p}$

$$
T_{\kappa p}=t_{\kappa p}\left(\frac{\alpha}{2} ; k\right) \cdot \sqrt{\frac{1-\rho_{b}^{2}}{n-2}}=1,86 \cdot \sqrt{\frac{1-0,5^{2}}{10-2}}=0,57 .
$$

Якщо $\left|\rho_{b}\right|<T_{\kappa p}$ - нульову гіпотезу приймають. Ранговий кореляційний зв'язок між досліджуваними ознаками статистично незначущий.

Перевірка гіпотези про значущість вибіркового коефіцієнта рангової кореляції Кендалла

Для того, щоб при рівні значущості $\alpha$ перевірити нульову гіпотезу $H_{0}: \tau_{\Gamma}=0$ про рівність нулю генерального коефіцієнта рангової кореляції

Кендалла при конкуруючій гіпотезі $H_{1}: \tau_{\Gamma} \neq 0$, необхідно обчислити критичну точку

$$
T_{\kappa p}=z_{\kappa p} \cdot \sqrt{\frac{2 \cdot(2 n+5)}{9 n \cdot(n-1)}},
$$

$n$ - об’єм вибірки, $z_{\kappa p}$ - критична точка, яку знаходять із таблиці значень функції Лапласа (додаток 2) із рівняння $\Phi\left(z_{к р}\right)=\frac{1-\alpha}{2}$ за рівнем значущості $\alpha$.

Якщо $\left|\tau_{b}\right|<T_{\kappa p}$ - нульову гіпотези приймають. Якщо $\left|\tau_{b}\right|>T_{\kappa p}$ - нульову гіпотезу відкидають. Між досліджуваними ознаками існує значущий ранговий кореляційний зв'язок.

Приклад 19.6. Експертна комісія оцінила роботу 20 підприємств за двома параметрами $A$ та $B$. Знайдений коефіцієнт рангової кореляції Кендалла дорівнює $\tau_{b}=0,6$.

При рівні значущості перевірити нульову гіпотезу $H_{0}: \tau_{\Gamma}=0$ про рівність нулю генерального коефіцієнта рангової кореляції Кендалла. За альтернативну прийняти гіпотезу $H_{1}: \tau_{\Gamma} \neq 0$.

Розв'язок. Знайдемо критичну точку $z_{к р}$

$$
\Phi\left(z_{\kappa p}\right)=\frac{1-\alpha}{2}=\frac{1-0,05}{2}=0,475 .
$$

Із таблиці значень функції Лапласа (додаток 2) знаходимо $z_{к р}=1,96$.
Знайдемо значення критичної точки

$$
T_{\kappa p}=z_{\kappa p} \cdot \sqrt{\frac{2 \cdot(2 n+5)}{9 n \cdot(n-1)}}=1,96 \cdot \sqrt{\frac{2 \cdot(2 \cdot 20+5)}{9 \cdot 20 \cdot(20-1)}}=0,32 .
$$

Так як $\left|\tau_{b}\right|>T_{\kappa p}$ - нульову гіпотезу відкидають. Між досліджуваними ознаками існує значущий ранговий кореляційний зв'язок.

## 19.3. Рангова кореляція

Ранжируваний ряд - це ряд значень досліджуваної кількісної чи якісної ознаки, які розташовані у порядку зростання або спадання величини ознаки.

Зв'язка - це група елементів ранжируваного ряду, які мають однакові значення. Об'єм зв'язки - кількість однакових значень у зв'язці.

Ранг - це порядковий номер значення досліджуваної ознаки у ранжируваному ряду. Елементам зв'язки присвоюють однакові ранги, які називають середніми рангами. Середній ранг - це середнє арифметичне порядкових номерів елементів зв'язки у ранжируваному ряду.

Приклад 19.9. На виставці представлено п’ять виробів. Результати оцінювання їх експертною комісією занесені у таблицю

| Номер виробу | Кількість балів |
| :---: | :---: |
| 1 | 6 |
| 2 | 7 |
| 3 | 10 |
| 4 | 8 |
| 5 | 7 |

Провести ранжирування даних за кількістю балів. Записати для кожного виробу його ранг.

Розв'язок. Розмістимо вироби у порядку зменшення отриманих балів

| Номер виробу | Кількість балів |
| :---: | :---: |
| 3 | 10 |
| 4 | 8 |
| 2 | 7 |
| 5 | 7 |
| 1 | 6 |

Вироби з номерами 2 та 5 набрали однакову кількість балів і утворюють у ранжируваному ряду зв'язку, тому для присвоєння їм рангів знаходимо середнє арифметичне їх номерів у ряду $R_{2,5}=\frac{3+4}{2}=3,5$. Отже вироби з номерами 2 та 5 отримують однакові ранги $R_{2}=R_{5}=3,5$.

Результуюча таблиця матиме вигляд

| Номер виробу | Кількість балів | Ранг |
| :---: | :---: | :---: |
| 3 | 10 | 1 |
| 4 | 8 | 2 |
| 2 | 7 | 3,5 |
| 5 | 7 | 3,5 |
| 1 | 6 | 5 |

Ранговий коефіцієнт кореляції Спірмена.
Коефіцієнт кореляції Спірмена використовують для перевірки наявності зв'язку між ознаками $A$ та $B$, які представлені за ранжированою (порядковою) шкалою.

Нехай результати дослідження занесені у таблицю:

| Об’єкт дослідження | Ранг об'єкта за ознакою $A, R_{A_{i}}$ | Ранг об'єкта за ознакою $B, R_{B_{i}}$ |
| :--- | :--- | :--- |
| 1 | $R_{A_{1}}$ | $R_{B_{1}}$ |
| 2 | $R_{A_{2}}$ | $R_{B_{2}}$ |
| $\cdots$ | $\cdots$ | $\cdots$ |
| $n$ | $R_{A_{n}}$ | $R_{B_{n}}$ |

Ранговий коефіцієнт кореляції Спірмена обчислюють за формулою $\rho=1-\frac{6\left[\left(R_{A_{1}}-R_{B_{1}}\right)^{2}+\left(R_{A_{2}}-R_{B_{2}}\right)^{2}+\cdots+\left(R_{A_{n}}-R_{B_{n}}\right)^{2}\right]}{n^{3}-n}=1-\frac{6 \sum_{i=1}^{n}\left(R_{A_{i}}-R_{B_{i}}\right)^{2}}{n^{3}-n}$, де $R_{A_{i}}$ та $R_{B_{i}}$ - ранги за ознаками $A$ та $B$ об'єкта з номером $i, n$ - кількість досліджуваних об'єктів.

При наявності однакових рангів використовують формулу

$$
\rho=1-\frac{6 \sum_{i=1}^{n}\left(R_{A_{i}}-R_{B_{i}}\right)^{2}+T_{A}+T_{B}}{n^{3}-n},
$$

де $T_{A}$ і $T_{B}$ - правобічні коефіцієнти, які розраховують за формули

$$
T_{A}=\frac{\sum_{i=1}^{L_{A}}\left(a_{i}^{3}-a_{i}\right)}{12}, T_{B}=\frac{\sum_{j=1}^{L_{B}}\left(b_{j}^{3}-b_{j}\right)}{12}
$$

де $L_{A}$ - кількість зв'язок у ранговому ряду $A, a_{i}$ - об'єм зв'язки з номером $i$ у ранговому ряду $A$;
де $L_{B}$ - кількість зв'язок у ранговому ряду $B, b_{j}$ - об'єм зв'язки з номером $j$ у ранговому ряду $B$.

Значення коефіцієнта кореляції Спірмена можуть змінюватися в межах від -1 до +1 , при цьому -1 відповідає повній протилежності послідовностей рангів, $a+1$ - їх повному збігу.

Приклад 19.10. В олімпіаді, яка складається з теоретичного та практичного турів, прийняло участь 10 студентів. Результати олімпіади занесені у таблицю.

Встановити, чи існує зв'язок між теоретичними знаннями студентів та практичними навичками.

| Прізвище та ініціали | Кількість балів за теоретичний тур | Кількість балів за практичний тур |
| :--- | :--- | :--- |
| Антонюк В.Р. | 18 | 15 |
| Борисенко К.Н | 10 | 12 |
| Варава Н.Г. | 14 | 11 |
| Грицай О.П. | 15 | 17 |
| Дордюк М.І. | 9 | 12 |
| Каленик О.О. | 11 | 12 |
| Лукаш Б.Б. | 15 | 16 |
| Мірченко Т.Р. | 10 | 13 |
| Тарасюк А.I. | 20 | 19 |
| Федчик Р.О. | 17 | 18 |

Розв'язок. Позначимо: ознака $A$ - кількість балів за теоретичний тур, ознака $B$ - кількість балів за практичний тур.

Оскільки закони розподілу ознак $A$ та $B$ невідомі, то застосовувати для виявлення зв'язку коефіцієнт кореляції Пірсона некоректно. Тому використаємо ранговий коефіцієнт кореляції Спірмена.

Присвоїмо кожному студенту ранги за теоретичний та практичний тури відповідно до кількості набраних балів. Для цього проранжируємо значення ознаки $A$ у порядку зменшення балів і запишемо порядкові номери та ранги для елементів отриманого ряду

| Кількість балів | 20 | 18 | 17 | 15 | 15 | 14 | 11 | 10 | 10 | 9 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| Порядковий <br> номер | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| Ранг | 1 | 2 | 3 | 4,5 | 4,5 | 6 | 7 | 8,5 | 8,5 | 10 |

Згідно цієї таблиці студенту, який набрав 20 балів присвоюється ранг 1 , студенту, який набрав 18 балів - ранг 2 , студенту, який набрав 17 - ранг 3 . Студенти, які набрали по 15 балів утворюють зв'язку і займають 4 та 5 місця у ранжируваному ряду, тому їм присвоюють середній ранг 4,5. Студенти, які набрали по 10 балів також утворюють зв'язку і займають 8 та 9 місця у ранжируваному ряду, тому їм присвоюють середній ранг 8,5.

Тепер проранжируємо значення ознаки $B$ у порядку зменшення балів і запишемо порядкові номери та ранги для елементів цього ряду:

| Кількість балів | 19 | 18 | 17 | 16 | 15 | 13 | 12 | 12 | 12 | 11 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| Порядковий <br> номер | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| Ранг | 1 | 2 | 3 | 4 | 5 | 6 | 8 | 8 | 8 | 10 |

Добавимо у вихідну таблицю з результатами олімпіади два стовпця з рангами студентів, а також для спрощення обчислень стовпець із значеннями $R_{A_{i}}-R_{B_{j}}$ та стовпець із значеннями $\left(R_{A_{i}}-R_{B_{j}}\right)^{2}, i=j$. Отримаємо таблицю

| Прізвище та ініціали | Кількість балів за теоретичний тур, ознака $A$ | Ранг $R_{A_{i}}$ | Кількість балів за практичний тур, ознака $B$ | Ранг $R_{B_{i}}$ | $R_{A_{i}}-R_{B_{i}}$ | $\left(R_{A_{i}}-R_{B_{i}}\right)^{2}$ |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| Антонюк В.Р. | 18 | 2 | 15 | 5 | -3 | 9 |
| Борисенко К.Н | 10 | 8,5 | 12 | 8 | 0,5 | 0,25 |
| Варава Н.Г. | 14 | 6 | 11 | 10 | -4 | 16 |


| Грицай О.П. | 15 | 4,5 | 17 | 3 | 1,5 | 2,25 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| Дордюк М.I. | 9 | 10 | 12 | 8 | 2 | 4 |
| Каленик О.О. | 11 | 7 | 12 | 8 | -1 | 1 |
| Лукаш Б.Б. | 15 | 4,5 | 16 | 4 | 0,5 | 0,25 |
| Мірченко Т.Р. | 10 | 8,5 | 13 | 6 | 2,5 | 6,25 |
| Тарасюк А.I. | 20 | 1 | 19 | 1 | 0 | 0 |
| Федчик Р.О. | 17 | 3 | 18 | 2 | 1 | 1 |

Так як рангові ряди містять зв'язки, то необхідно врахувати поправочні коефіцієнти $T_{A}$ і $T_{B}$.

У ранговому ряду $A$ є дві зв'язки, кожна об'ємом по 2 елементи: два ранги мають значення 4,5 і два ранги мають значення 8,5 . Звідси $L_{A}=2$, $a_{1}=a_{2}=2$, а коефіцієнт $T_{A}$ дорівнює

$$
T_{A}=\frac{\sum_{i=1}^{L_{A}}\left(a_{i}^{3}-a_{i}\right)}{12}=\frac{\left(2^{3}-2\right)+\left(2^{3}-2\right)}{12}=1
$$

У ранговому ряду $B$ є одна зв'язка об'ємом 3 елементи. Отже $L_{B}=1$, $b_{1}=3$. Коефіцієнт $T_{B}$ дорівнює

$$
T_{B}=\frac{\sum_{j=1}^{L_{B}}\left(b_{j}^{3}-b_{j}\right)}{12}=\frac{3^{3}-3}{12}=2
$$

Знаходимо ранговий коефіцієнт кореляції Спірмена
$\rho=1-\frac{6 \sum_{i=1}^{n}\left(R_{A_{i}}-R_{B_{i}}\right)^{2}+T_{A}+T_{B}}{n^{3}-n}=$ $=1-6 \cdot \frac{9+0,25+16+2,25+4+1+0,25+6,25+0+1+1+2}{10^{3}-10}=0,74$.

Згідно шкали Чеддока між теоретичними знаннями та практичними навиками студентів існує сильний зв'язок.

Коефіцієнт рангової кореляції Кендалла

Ранговий коефіцієнт кореляції Кендалла (як і ранговий коефіцієнт кореляції Спірмена) використовують для перевірки наявності зв'язку між ознаками $A$ та $B$, які представлені за порядковою шкалою.

Нехай провели дослідження $n$ об'єктів сукупності і присвоїли їм відповідні ранги за ознаками $A$ та $B$. Упорядкуємо ці об'єкти за зростанням рангів ознаки $A$ і занесемо отримані результати у таблицю

| Ранг $A$ | $R_{A_{1}}$ | $R_{A_{2}}$ | $\cdots$ | $R_{A_{n}}$ |
| :---: | :---: | :---: | :---: | :---: |
| Ранг $B$ | $R_{B_{1}}$ | $R_{B_{2}}$ | $\cdots$ | $R_{B_{n}}$ |

Ранги ознаки $B$ при цьому, як правило, будуть неупорядковані (упорядкованими за зростанням вони будуть тільки у випадку, коли ранги обох ознак співпадають).

Обчислимо кількість перестановок елементів рангового ряду $B$ для упорядкування їх за зростанням. Для цього знайдемо кількість рангів ознаки $B$, які менші від $R_{B_{1}}$ і знаходяться правіше від $R_{B_{1}}$. Позначимо отримане число через $K_{1}$. Знайдемо кількість рангів ознаки $B$, які менші від $R_{B_{2}}$ і знаходяться правіше від $R_{B_{2}}$. Позначимо отримане число через $K_{2}$. Виконаємо цю операцію для усіх рангів ознаки $B$ крім останнього. У результаті виконаних дій отримаємо ряд чисел $K_{1}, K_{2}, \ldots, K_{n-1}$. Знайдемо суму цих чисел

$$
K=K_{1}+K_{2}+\ldots+K_{n-1}
$$

Коефіцієнт рангової кореляції Кендалла обчислюють за формулою

$$
\tau=1-\frac{4 K}{n(n-1)}
$$

У випадку, коли рангові ряди містять зв'язки, використовують формулу

$$
\tau=1-\frac{2 K}{\sqrt{\left(\frac{n(n-1)}{2}-T_{A}\right) \cdot\left(\frac{n(n-1)}{2}-T_{B}\right)}} .
$$

де $T_{A}$ та $T_{B}$ - поправочні коефіцієнти, які розраховуються за формулами:

$$
T_{A}=\frac{\sum_{i=1}^{L_{A}}\left(a_{i}^{2}-a_{i}\right)}{2}, T_{B}=\frac{\sum_{j=1}^{L_{B}}\left(b_{j}^{2}-b_{j}\right)}{2}
$$

де $L_{A}$ - кількість зв'язок у ранговому ряду $A, a_{i}$ - об'єм зв'язки з номером $i$ у ранговому ряду $A$;
де $L_{B}$ - кількість зв'язок у ранговому ряду $B, b_{j}$ - об'єм зв'язки з номером $j$ у ранговому ряду $B$.

Як і ранговий коефіцієнт кореляції Спірмена, коефіцієнт кореляції Кендала може змінюватися в межах від -1 до +1 , при цьому -1 відповідає повній протилежності послідовностей рангів, $a+1$ - їх повному збігу.

Рангові коефіцієнти кореляції Спірмена і Кендалла пов'язані рівнянням $\rho \approx 1,5 \cdot \tau$ (при умові, що $\rho$ і $\tau$ не дуже близькі до 1 ).

Для вибірок із генеральних сукупностей із нормальними розподілами можуть бути отримані оцінки для звичайного коефіцієнта кореляції

$$
r_{x y}=2 \sin \left(\rho \frac{\pi}{6}\right) \text { та } r_{x y}=\sin \left(\tau \frac{\pi}{2}\right)
$$

Приклад 19.11. Експертна комісія оцінила 10 виробів за двома ознаками $A$ та $B$. Результати оцінювання наведено у таблиці

| Номер виробу | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| Ранг $R_{A_{i}}$ | 2 | 8 | 6 | 4 | 10 | 7 | 5 | 9 | 1 | 3 |
| Ранг $R_{B_{i}}$ | 5 | 8 | 10 | 3 | 7 | 9 | 4 | 6 | 1 | 2 |

Знайти рангові коефіцієнти кореляції Кендалла та Спірмена.
Розв'язок. Запишемо в окрему таблицю пари рангів, упорядкувавши їх за зростанням рангів ознаки $A$

| Ранг $R_{A_{i}}$ | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| Ранг $R_{B_{i}}$ | 1 | 5 | 2 | 3 | 4 | 10 | 9 | 8 | 6 | 7 |

Правіше $R_{B_{1}}=1$ немає менших рангів, тому $K_{1}=0$. Правіше $R_{B_{2}}=5 € 3$ менших ранги, тому $K_{2}=3$. Правіше $R_{B_{3}}=2$ немає менших рангів, тому
$K_{3}=0$. Аналогічно знаходимо: $K_{4}=0 ; K_{5}=0 ; K_{6}=4 ; K_{7}=3 ; K_{8}=2 ; K_{9}=0$. Сума $K=12$.

Знайдемо ранговий коефіцієнт кореляції Кендалла $\tau=1-\frac{4 K}{n(n-1)}=1-\frac{4 \cdot 12}{10 \cdot 9}=0,47$.

Знайдемо ранговий коефіцієнт кореляції Спірмена. Для спрощення обчислень додаємо у таблицю з рангами два рядки із значеннями $R_{A_{i}}-R_{B_{j}}$ та $\left(R_{A_{i}}-R_{B_{j}}\right)^{2}, i=j$. Отримаємо таблицю

| Ранг $R_{A_{i}}$ | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| Ранг $R_{B_{i}}$ | 1 | 5 | 2 | 3 | 4 | 10 | 9 | 8 | 6 | 7 |
| $R_{A_{i}}-R_{B_{i}}$ | 0 | -3 | 1 | 1 | 1 | -4 | -2 | 0 | 3 | 3 |
| $\left(R_{A_{i}}-R_{B_{i}}\right)^{2}$ | 0 | 9 | 1 | 1 | 1 | 16 | 4 | 0 | 9 | 9 |

Підставимо отримані значення у формулу для коефіцієнта рангової кореляції Спірмена
$\rho=1-\frac{6 \cdot \sum_{i=1}^{n}\left(R_{A_{i}}-R_{B_{i}}\right)^{2}}{n^{3}-n}=1-6 \cdot \frac{0+9+1+1+1+16+4+0+9+9}{10^{3}-10}=0,7$.
Отримані результати узгоджуються із твердженням, що коефіцієнти рангової кореляції Спірмена і Кендалла пов'язані співвідношенням $\rho \approx 1,5 \cdot \tau$.

