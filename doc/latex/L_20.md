## Лекція 20. Елементи регресивного аналізу

За результатами експерименту можна отримати наближене вираження (оцінку) функції регресії (тобто вибіркові рівняння регресії) вигляду:

$$
\bar{y}_{x}=f(x) \text { та } \bar{x}_{y}=\varphi(y)
$$

де $\bar{y}_{x}$ - умовне середнє змінної $Y$ при фіксованому значенні $X, \bar{x}_{y}$ - умовне середнє змінної $X$ при фіксованому значенні $Y$.

Кореляційна залежність між величинами $X$ і $Y$ може бути подана як функціональна залежність між $\bar{y}_{x}$ і $X$ або $\bar{x}_{y}$ і $Y$.

Методи знаходження таких залежносте і оцінки їхніх статистичних властивосте складають зміст регресивного аналізу.

## 20.1.Метод найменших квадратів. Парна лінійна регресія.

Завдання: за заданими значеннями $\left(x_{1}, y_{1}\right), \ldots,\left(x_{n}, y_{n}\right)$ і відповідними частотами цих значень $n_{i j}$, а також за умовними середніми $\bar{x}_{y_{j}}$ та $\bar{y}_{x_{i}}$ знайти функції регресії $f(x)$ і $\varphi(y)$.

Найпростішою формою кореляційно-регресивного зв'язку є лінійний зв'язок між двома величинами - парна лінійна регресія. Її рівняння:

$$
\bar{y}_{x}=a+b x \text { або } \bar{x}_{y}=c+d y
$$

У кожному з цих рівнянь по дві невідомі величини - коефіцієнти лінійної регресії. Так у рівнянні $\bar{y}_{x}=a+b x$ це параметри $a$ і $b$. Однозначно визначити їх за вибіркою неможливо - через вплив випадкових чинників.

Вплив цих випадкових відхилень (похибок, помилок, збурень, шуму) на спостережувані значення подають у наступному вигляді:

$$
\bar{y}_{x_{i}}=a+b x_{i}+\varepsilon_{i},(i=\overline{1, n})
$$

де $\varepsilon_{i}$ - випадкова змінна, вона характеризує відхилення значень вибірки від теоретичної регресії.

Потрібно знайти значення невідомих параметрів $a$ і $b$, щоб випадкові відхилення $\varepsilon_{i}$ у сукупності були близькі до нуля.

Суть методу найменших квадратів: знати таку значення параметрів $a$ і $b$, щоб була як можна меншою зважена сума квадратів відхилень:

$$
\sum_{i=1}^{n} \varepsilon_{i}^{2} \cdot m_{x_{i}} \rightarrow \min
$$

Тоді буде знайдено рівняння прямої, найменш віддаленої від усіх точок $\left(x_{i}, \bar{y}_{x_{i}}\right)$ з урахуванням їхніх вагів.

Записавши необхідну умову існування її мінімуму (рівність нулю двох частинних похідних), отримують лінійну систему двох рівнянь із двома змінними $a$ і $b$.

$$
\left\{\begin{array}{l}
n a+b \cdot \sum_{i=1}^{n} x_{i}=\sum_{i=1}^{n} y_{i}  \tag{20.1}\\
a \cdot \sum_{i=1}^{n} x_{i}+b \cdot \sum_{i=1}^{n} x_{i}^{2}=\sum_{i=1}^{n} x_{i} \cdot y_{i}
\end{array}\right.
$$

Розв'язавши систему (20.1) відносно параметрів $a$ і $b$, знайдемо:

$$
\begin{align*}
& a=\bar{y}-b \cdot \bar{x} ; \\
& b=\frac{\frac{\sum x_{i} y_{i}}{n}-\bar{x} \cdot \bar{y}}{\frac{\sum x_{i}^{2}}{n}-(\bar{x})^{2}}=\frac{\overline{x y}-\bar{x} \cdot \bar{y}}{\overline{x^{2}} \cdot(\bar{x})^{2}}=\frac{K_{x y}^{*}}{\sigma_{x}^{2}} . \tag{20.2}
\end{align*}
$$

де $\bar{x}=\frac{1}{n} \sum_{i=1}^{n} x_{i}, \bar{y}=\frac{1}{n} \sum_{j=1}^{n} y_{j}, \overline{x^{2}}=\frac{1}{n} \sum_{i=1}^{n} x_{i}^{2}, \overline{x y}=\frac{1}{n} \sum_{i=1}^{n} x_{i} \cdot y_{i}, n$ - число вимірювань.
Помноживши ліву і праву частини (20.2) на $\frac{\sigma_{x}}{\sigma_{y}}$, дістанемо:

$$
\begin{equation*}
\frac{\sigma_{x}}{\sigma_{y}} \cdot b=\frac{K_{x y}^{*}}{\sigma_{x}^{2}} \cdot \frac{\sigma_{x}}{\sigma_{y}}=\frac{K_{x y}^{*}}{\sigma_{x} \cdot \sigma_{y}}=r_{x y} \Rightarrow b=r_{x y} \cdot \frac{\sigma_{y}}{\sigma_{x}}, \tag{20.3}
\end{equation*}
$$

де $r_{x y}$ - парний коефіцієнт кореляції між ознаками $X$ і $Y$.

Тоді

$$
\begin{equation*}
a=\bar{y}-b \cdot \bar{x}=\bar{y}-r_{x y} \cdot \frac{\sigma_{y}}{\sigma_{x}} \cdot \bar{x} \tag{20.4}
\end{equation*}
$$

3 урахуванням (20.3), (20.4) рівняння лінійної парної регресії набере такого вигляду:

$$
\begin{equation*}
y_{x}=r_{x y} \cdot \frac{\sigma_{x}}{\sigma_{y}} \cdot(x-\bar{x})+\bar{y} \tag{20.5}
\end{equation*}
$$

Для визначення оцінки параметрів лінійної залежності (регресії) $Y$ на $X$ $y_{x}=a+b \cdot x_{i}$, можна також застосувати формулу через незміщену статистичну оцінку (виправлену дисперсію) ознаки $X: b=\frac{K_{x y}^{*}}{S_{x}^{2}}$.

Для лінійної регресії $X$ на $Y$ отримують аналогічні формули ( $x_{y}=c+d y$ ):

$$
\begin{gather*}
d=\frac{K_{x y}^{*}}{\sigma_{y}^{2}} \text { або через виправлену дисперсію } d=\frac{K_{x y}^{*}}{S_{y}^{2}}, \text { тоді } c=\bar{x}-d \cdot \bar{y}: \\
x_{y}=r_{x y} \cdot \frac{\sigma_{x}}{\sigma_{y}} \cdot(y-\bar{y})+\bar{x} \tag{20.6}
\end{gather*}
$$

Прямі регресії $Y$ на $X$ і $X$ на $Y$ співпадають коли $\left|r_{x y}\right|=1$, тобто у разі функціональної лінійної залежності між величинами $X$ і $Y$.

Співвідношення $\sqrt{b \cdot d}=\left|r_{x y}\right|$ використовують для контролю обчислень.
Коефіиієнт детермінації $R^{2}=r_{x y}^{2}$, дорівнює квадрату коефіцієнта множинної кореляції. Коефіцієнт детермінації $R^{2}$ показує, в якій мірі варіації значень величини $Y$ залежить від значень фактору $X$.

Приклад 20.5. Залежність обсягу отриманого прибутку деяким умовним підприємством регіону від вартості основних виробничих фондів наведено парним статистичним розподілом вибірки:

| Основні фонди, млн грн, $x_{k}$ | 2,5 | 2,8 | 3 | 3,2 | 3,5 | 4,2 | 4,5 | 5 | 5,3 | 6 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| Прибуток, млн грн, $y_{k}$ | 1,2 | 1,5 | 1,7 | 2,2 | 2,6 | 3,1 | 3,4 | 4,2 | 4,7 | 5,4 |

Методом найменших квадратів визначити оцінки невідомих параметрів лінійної парної регресії. Обчислити коефіцієнт кореляції та детермінації, зробити висновки.

Розв'язання: Нехай між ознаками $X$ та $Y$ існує лінійна функціональна залежність $y_{x}=a+b \cdot x_{i}$.

Для визначення параметрів $a$ та $b$ скористаємося методом найменших квадратів, що має такий вигляд:

$$
\left\{\begin{array}{l}
n a+b \cdot \sum_{i=1}^{n} x_{i}=\sum_{i=1}^{n} y_{i} \\
a \cdot \sum_{i=1}^{n} x_{i}+b \cdot \sum_{i=1}^{n} x_{i}^{2}=\sum_{i=1}^{n} x_{i} \cdot y_{i}
\end{array}\right.
$$

| № ㅍ/II | $x_{k}$ | $y_{k}$ | $x_{k}^{2}$ | $x_{k} y_{k}$ | $y_{k}^{2}$ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | 2,5 | 1,2 | 6,25 | 3,0 | 1,44 |
| 2 | 2,8 | 1,5 | 7,84 | 4,2 | 2,25 |
| 3 | 3 | 1,7 | 9 | 5,1 | 2,89 |
| 4 | 3,2 | 2,2 | 10,24 | 7,0 | 4,84 |
| 5 | 3,5 | 2,6 | 12,25 | 9,1 | 6,76 |
| 6 | 4,2 | 3,1 | 17,64 | 13,0 | 9,61 |
| 7 | 4,5 | 3,4 | 20,25 | 15,3 | 11,56 |
| 8 | 5 | 4,2 | 25 | 21,0 | 17,64 |
| 9 | 5,3 | 4,7 | 28,09 | 24,9 | 22,09 |
| 10 | 6 | 5,4 | 36 | 32,4 | 29,16 |
| $\sum$ | 40 | 30 | 172,56 | 135,07 | 108,24 |

$$
\left\{\begin{array} { l } 
{ 1 0 \cdot a + 4 0 \cdot b = 3 0 } \\
{ 4 0 \cdot a + 1 7 2 , 5 6 \cdot b = 1 3 5 , 0 7 }
\end{array} \Rightarrow \left\{\begin{array}{l}
a=-1,799 \\
b=1,12
\end{array}\right.\right.
$$

Отже, рівняння регресії буде $y_{x}=-1,799+1,12 \cdot x_{i}$.

Для обчислення коефіцієнта кореляції $r_{x y}$, визначимо кореляційний момент $K_{x y}^{*}=\overline{x y}-\bar{x} \cdot \bar{y}=13,507-4 \cdot 3=1,507$.
$S_{x}^{2}=\frac{n}{n-1} D_{x}=\frac{10}{9} \cdot 1,2544=1,394 ; \quad S_{x}=1,18 ;$
$S_{y}^{2}=\frac{n}{n-1} D_{y}=\frac{10}{9} \cdot 1,8225=2,025 ; \quad S_{y}=1,42$.
Вибірковий коефіцієнт кореляції
$r_{x y}=\frac{K_{x y}^{*}}{\sqrt{S_{x}^{2} \cdot S_{y}^{2}}}=\frac{1,507}{1,18 \cdot 1,42} \approx 0,9$.
Побудуємо кореляційне поле та регресивну функцію
![](https://cdn.mathpix.com/cropped/2025_05_11_aab041899c63824e8ffeg-5.jpg?height=872&width=1095&top_left_y=1100&top_left_x=526)

Прямі регресії на кореляційному полі

Визначимо коефіцієнт детермінації $R^{2}=r_{x y}^{2}=0,9^{2}=0,81$.
Коефіцієнт детермінації $R^{2}=0,81$. Це означає, що зміна обсягу прибутку підприємства на $81 \%$ визначається варіацією вартості основних фондів і $19 \%$ - іншими випадковими факторами.

Приклад 20.2. Дано вибірку

| $x_{i}$ | 3,72 | 3,09 | 3,47 | 3,25 | 3,34 | 3,11 | 3,51 | 3,34 | 3,68 | 3,40 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| $y_{i}$ | 1,49 | 2,73 | 3,32 | 3,32 | 3,69 | 3,67 | 3,30 | 2,55 | 3,11 | 3,60 |

Обчислити коефіцієнт кореляції, визначити і побудувати прямі регресії $Y$ на $X$ та $X$ на $Y$.

| $i$ | $x_{i}$ | $x_{i}-\bar{x}_{B}$ | $y_{i}$ | $y_{i}-\bar{y}_{B}$ | $\left(x_{i}-\bar{x}_{B}\right)\left(y_{i}-\bar{y}_{B}\right)$ | $\left(x_{i}-\bar{x}_{B}\right)^{2}$ | $\left(y_{i}-\bar{y}_{B}\right)^{2}$ |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | 3,72 | 0,33 | 1,49 | -1,59 | -0,525 | 0,109 | 2,528 |
| 2 | 3,09 | -0,3 | 2,73 | -0,35 | 0,105 | 0,09 | 0,123 |
| 3 | 3,47 | 0,08 | 3,32 | 0,24 | 0,019 | 0,006 | 0,058 |
| 4 | 3,25 | -0,14 | 3,32 | 0,24 | -0,034 | 0,020 | 0,058 |
| 5 | 3,34 | -0,05 | 3,69 | 0,61 | -0,03 | 0,003 | 0,372 |
| 6 | 3,11 | -0,28 | 3,67 | 0,59 | -0,165 | 0,078 | 0,348 |
| 7 | 3,51 | 0,12 | 3,30 | 0,22 | 0,026 | 0,014 | 0,048 |
| 8 | 3,34 | -0,05 | 2,55 | -0,53 | 0,027 | 0,003 | 0,281 |
| 9 | 3,68 | 0,29 | 3,11 | 0,03 | 0,009 | 0,084 | 0,001 |
| 10 | 3,40 | 0,01 | 3,60 | 0,52 | 0,005 | 0,000 | 0,270 |
| $\sum$ | 33,91 |  | 30,78 |  | -0,56 | 0,41 | 4,09 |

Визначимо оцінки параметрів лінійної залежності (регресії) $Y$ на $X$ $y_{x}=a+b \cdot x_{i}$, та лінійної регресії $X$ на $Y: x_{y}=c+d y$.

Для обчислення коефіцієнта кореляції $r_{x y}$, визначимо кореляційний момент $K_{x y}^{*}=\frac{1}{n-1} \cdot \sum_{j=1}^{n} \sum_{i=1}^{k}\left(x_{j}-\bar{x}\right) \cdot\left(y_{i}-\bar{y}\right)=\frac{-0,56}{9}=-0,06$.
$S_{x}^{2}=\frac{1}{n-1} \cdot \sum_{i=1}^{n}\left(x_{i}-\bar{x}\right)^{2}=\frac{1}{9} \cdot 0,41=0,05 ; \quad S_{x}=0,22 ;$
$S_{y}^{2}=\frac{1}{n-1} \cdot \sum_{i=1}^{n}\left(y_{i}-\bar{y}\right)^{2}=\frac{1}{9} \cdot 4,09=0,45 ; \quad S_{y}=0,67$.
Вибірковий коефіцієнт кореляції
$r_{x y}=\frac{K_{x y}^{*}}{S_{x} \cdot S_{y}}=-\frac{0,06}{0,22 \cdot 0,67} \approx-0,41$.
Оцінимо параметри:
$b=\frac{K_{x y}^{*}}{S_{x}^{2}}=-\frac{0,06}{0,05}=-1,2$, тоді $a=\bar{y}-b \cdot \bar{x}=3,08+1,2 \cdot 3,39=7,15$.
Оцінимо параметри:
$d=\frac{K_{x y}^{*}}{S_{y}^{2}}=-\frac{0,06}{0,45}=-0,13$, тоді $c=\bar{x}-d \cdot \bar{y}=3,39+0,13 \cdot 3,08=3,8$.
Таким чином, прямі регресії мають наступні рівняння:

$$
\begin{aligned}
y_{x}=a+b \cdot x_{i} & \Rightarrow y_{x}=7,15-1,2 \cdot x_{i} \\
x_{y}=c+d \cdot y_{i} & \Rightarrow x_{y}=3,8-0,13 \cdot y_{i}
\end{aligned}
$$

Для перевірки застосуємо співвідношення:
$\sqrt{b \cdot d}=\left|r_{x y}\right| \Rightarrow \sqrt{(-1,2) \cdot(-0,13)}=0,39$.
3 урахуванням округлення помилок можна вважати, що $0,39 \approx|-0,41|$.
![](https://cdn.mathpix.com/cropped/2025_05_11_aab041899c63824e8ffeg-7.jpg?height=640&width=849&top_left_y=1222&top_left_x=626)

